<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Modify Me With jQuery!</title>
    <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
    <style>
        body{
            font-family:Helvetica Neue, Helvetica, Arial, sans-serif;
        }
        #container{     width:80%; height:100%; margin: auto;}
        .left,.right{   padding: 1em; width: 40%; }
        .left{  float: left; }
        .right{ float: right; }
        .clear{ clear: both; }
        .rick{
            background-color: #C2185B;
            padding: 1em 2em;
            color: #fff;
            font-weight: bold;
            -moz-border-radius: 5px;
            -webkit-border-radius: 5px;
            border-radius: 5px;
            border: none;
            -webkit-box-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
            -moz-box-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
            box-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
            position: relative;
            cursor: pointer;}
        .rick:hover{
            background-color:#E91E63;
            -webkit-box-shadow: 0 0 7px rgba(0, 0, 0, 0.7);
            -moz-box-shadow: 0 0 7px rgba(0, 0, 0, 0.7);
            box-shadow: 0 0 7px rgba(0, 0, 0, 0.7);
        }
        li{ padding: 0; margin: 1em; display: inline-block }
        h1{ text-align: center }
        #lyrics{
            padding: 1em;
        }
    </style>
</head>
<body>

<div id="container">
    <h1>A jQuery Exercise</h1>
    <div class="left">
        <h2 id="lyricsHeading">Here's where the lyrics should appear:</h2>
        <div id="lyrics"></div>
    </div>
    <div class="right">
        <h2>Generate your lyrics:</h2>
        <ul class="rickRoll">
            <li><button>Gonna</button></li>
            <li><button>You</button></li>
            <li><button>Give</button></li>
            <li><button>Go</button></li>
            <li><button>Never</button></li>
            <li><button>Let</button></li>
            <li><button>Up</button></li>
        </ul>
    </div>
    <div class="clear"></div>
</div>


<script>
    // first, we grab a set of re-usable references to elements that we will need.
    var ul = $('ul.rickRoll');
    var lyrics = $('#lyrics');
    var submitButton = $('<button>Check Lyrics</button>');
    var resetButton = $('<button>Reset</button>');

    /**
     * with this, we easily create a couple of new buttons and
     * attach them to the unordered list (ul)
     */
    ['Down','Run','Around','And','Desert'].forEach(function(item){
        ul.append($("<li><button>"+item+"</button></li>"))
    });
    /**
     * Here, we demonstrate method chaining.
     * this adds the class "rick" to all buttons that exist in the dom at this point.
     */
    $('button').addClass('rick').click(function(){
        // "this" is actually a DOM-Node, that we can select with jQuery.
        // when we do that, we can fetch its contents with the .html() or .text() method.
        // we also add a blank space afterwards t make the lyrics more readable.
        lyrics.append($(this).html() + " ");
    });

    // attach two new buttons to the left-hand column
    lyrics.after(resetButton).after(submitButton);

    // attach an event listener _after_ the button was inserted in the DOM tree.
    submitButton.click(function(){
        /**
         * launch an AJAX request to the checkLyrics.php script.
         * pass the contents of #lyrics  as a POST parameter.
         * .post() is a shorthand for .ajax({...})
         */
        $.post( 'checkLyrics.php',
                // the second parameter is an object that holds all data passed with the POST request.
                {
                    lyrics : lyrics.text()
                },
                // the third parameter is the success handler that is passed the server response.
                function(response){
                    // note that functions are visible in the entire scope, even if delcared later!
                    //
                    var colorGenerator = colorIze(response.result);
                    colorGenerator(lyrics);

                    /**
                     * This is to demonstrate closures.
                     * This function returns a function!
                     * The returned function takes a jQuery Object that will be given a background-color.
                     */
                    function colorIze(diff){
                        function colorRed(targetElement){
                            targetElement.css('background-color','#FFCDD2');
                        }
                        function colorGreen(targetElement){
                            targetElement.css('background-color','#CDDC39');
                        }
                        // if the resulting difference is 0,
                        // we return a function that colors the element green
                        // otherwise it will be colored red
                        return diff == 0 ? colorGreen : colorRed;
                    }
                }
        ); // this is where the .post() method ends.
    });

    /**
     * reset the contents of lyrics, simply be overwriting the html contents of it.
     * that way, the user can try to correct errors.
     */
    resetButton.click(function(){
        lyrics.html("");
        lyrics.css('background-color','transparent');
    });

</script>
</body>
</html>